海豚的秘密大家都知道海豚这种可爱的海洋动物。但又有多少人知道，海豚可以永远不睡觉。是什么样的能力，使得海豚可以永远保持清醒呢？
依靠的是海豚大脑特殊的运作方式。像人一样，海豚的大脑也分为左脑和右脑两个部分。在海豚活跃的状态下，左脑和右脑都是清醒的：当然，海豚也是血肉之躯，也是需要休息的。在海豚休息的状态下，其中一半大脑会进入睡眠，另一半大脑仍然保持清醒，以面对各种外界情况。
每隔两个小时，这种一半睡眠一半清醒的状态会进行交替，比如这一刻左脑睡眠右脑清醒，下一刻左脑清醒右脑睡眠。这就是海豚永远不会真正睡觉的秘密。


## 蓝绿部署
英文名Blue Green Deployment，是一种可以保证系统在不间断提供服务的情况下上线的部署方式。
如何保证系统不间断提供服务呢？
蓝绿部署的模型中包含两个集群A、B，就好比海豚的左脑和右脑。
在没有上线的正常情况下，集群A和集群B的代码版本是一致的，并且同时对外提供服务。

在系统升级的时候下，我们首先把一个集群（比如集群A）从负载列表中摘除，进行新版本的部署。集群B仍然继续提供服务。

当集群A升级完毕，我们把负载均衡重新指向集群A，再把集群B从负载列表中摘除，进行新版本的部署。集群A重新提供服务。

最后，当集群B也升级完成，我们把集群B也恢复到负载列表当中。这个时候，两个集群的版本都已经升级，并且对外的服务几乎没有间断过。

## 滚动部署
滚动部署，英文Rolling update，同样是一种可以保证系统在不间断提供服务的情况下上线的部署方式。

和蓝绿部署不同的是，滚动部署对外提供服务的版本并不是非此即彼，而是在更细的粒度下平滑完成版本的升级。

如何做到细粒度平滑升级版本呢？

滚动部署只需要一个集群，集群下的不同节点可以独立进行版本升级。比如在一个16节点的集群中，我们选择每次升级4个节点：
以此类推，最终所有的节点都升级了版本。

## 蓝绿部署 VS 滚动部署
蓝绿部署
优点  
    1 同一时间  对外服务的只有一个版本，容易定位问题。
    2 升级和回滚以集群为粒度，操作相对简单
缺点
    需要维护两个集群，成本较高
滚动部署
优点
    只需要维护一个集群，成本较低
缺点
    1 上线过程中，两个版本同时对外服务，不容易定位问题，且容易造成数据错乱
    2 升级和回滚以节点为粒度，操作相对复杂
